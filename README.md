
# Latent linear dynamics in spatiotemporal medical data
Official implementation of Latent linear dynamics in spatiotemporal medical data ([Arxiv](https://arxiv.org/abs/2103.00930)).

## Enviroment
We use the following libraries

```
tensorflow 2.4.1
tensorflow-probability 0.12.1
numpy 1.19.5
cv2 4.5.1
pandas 1.2.2
tqdm 4.57.0
json 2.0.9
```

## Architecture
<img src="https://user-images.githubusercontent.com/10964648/109638288-239ba300-7b4e-11eb-9450-4e1e60f2a86c.PNG" alt="Architecture" width="350"/>

The intensity dynamics is modelled with a Linear Gaussian State Space Model (LGSSM), not on the raw image time series but on the latent process generated by a Variational Auto-Encoder (VAE). The VAE - and LGSSM parameters are jointly updated by maximizing the evidence lower bound of the log likelihood:

<img src="https://render.githubusercontent.com/render/math?math=\log p_\theta(\mathbf{y}) \geq \mathbb{E}_{q_\phi(\mathbf{x} \mid \mathbf{y})} \Big[ \log p_\theta(\mathbf{y} \mid \mathbf{x}) + \log \dfrac{p_\theta(\mathbf{x})}{q_\phi(\mathbf{x \mid y})} + \mathbb{E}_{p_\gamma(\mathbf{z} \mid \mathbf{x})} \Big[\log \dfrac{p_\gamma(\mathbf{x},\mathbf{z})}{p_\gamma(\mathbf{z} \mid \mathbf{x})} \Big] \Big]">

## Run
TBD

## Result
Smooth imputing when every 5th frame is known
![impute5](https://user-images.githubusercontent.com/10964648/109644778-3b772500-7b56-11eb-8789-eec88e1f7323.gif)

## Citation
```
@misc{gunnarsson2021latent,
      title={Latent linear dynamics in spatiotemporal medical data}, 
      author={Niklas Gunnarsson and Jens Sjölund and Thomas B. Schön},
      year={2021},
      eprint={2103.00930},
      archivePrefix={arXiv},
      primaryClass={physics.med-ph}
}
```
